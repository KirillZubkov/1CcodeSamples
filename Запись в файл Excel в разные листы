	Попытка
		Excel = Новый COMОбъект("Excel.Application");
	Исключение
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());
		Возврат;
	КонецПопытки;
	
	Книга = Excel.WorkBooks.Add();
	Лист1 = Книга.WorkSheets().Add();
	Лист1.Name = "Несопоставленные ЛК КРСТ";
	Лист2 = Книга.WorkSheets(2);
	Лист2.Name = "Несопоставленные КРСТ";
	
	Лист1.Cells(1, 1).Value = "Код ОКТМО";
	Лист1.Cells(1, 2).Value = "Наименование населенного пункта";
	Лист1.Cells(1, 3).Value = "Наименование сельского поселения";
	Лист1.Cells(1, 4).Value = "Наименование муниципального района/округа";
	Лист1.Cells(1, 5).Value = "Наименование субъекта РФ";
	НомерСтроки = 2;
	
	ЛогСтыковокПоНаименованию = Новый ТекстовыйДокумент;
	Для каждого Строка Из ТЗНестыковкиЛК Цикл
		НаименованиеЛК = ОбрезатьСтрочныеБуквыВНачалеСтроки(Строка.НаименованиеЛК);
		СельскоеПоселениеЛК = СокрЛП(Строка.СельскоеПоселениеЛК);
		РайонЛК = ОтсечьПоследнееСловоВСтроке(Строка.РайонЛК);
		
		ПараметрыОтбора = Новый Структура("НаименованиеОбрезанное, СельскоеПоселение, РайонОбрезанный", НаименованиеЛК, СельскоеПоселениеЛК, РайонЛК);
		НайденныеСтроки = ТЗНестыковкиКРСТ.НайтиСтроки(ПараметрыОтбора);
		Если НайденныеСтроки.Количество() <> 1 Тогда
			ПараметрыОтбора = Новый Структура("НаименованиеОбрезанное, РайонОбрезанный", НаименованиеЛК, РайонЛК);
			НайденныеСтроки = ТЗНестыковкиКРСТ.НайтиСтроки(ПараметрыОтбора);
		КонецЕсли;
		
		Если НайденныеСтроки.Количество() = 1 Тогда
			НайденнаяСтрока = НайденныеСтроки[0];
			//ОбновитьЭлементСправочникаОКТМО(Строка.Ссылка, Строка.СубъектРФКодОКТМО_ЛК, НайденнаяСтрока); 
			
			ЛогСтыковокПоНаименованию.ДобавитьСтроку(СтрШаблон("ЛК: %1, %2, %3, %4, %5; ///КРСТ: %6, %7, %8, %9, %10, ", Строка.КодОКТМО_ЛК, 
				Строка.НаименованиеЛК, Строка.СельскоеПоселениеЛК, Строка.РайонЛК, Строка.СубъектРФНаименованиеЛК, НайденнаяСтрока.КодОКТМО, 
				НайденнаяСтрока.Наименование, НайденнаяСтрока.СельскоеПоселение, НайденнаяСтрока.Район, НайденнаяСтрока.СубъектРФНаименование) + НайденнаяСтрока.КодКРСТ);
				
			ТЗНестыковкиКРСТ.Удалить(НайденнаяСтрока);	
		Иначе
			Лист1.Cells(НомерСтроки, 1).Value = Строка.КодОКТМО_ЛК;
			Лист1.Cells(НомерСтроки, 2).Value = Строка.НаименованиеЛК;
			Лист1.Cells(НомерСтроки, 3).Value = Строка.СельскоеПоселениеЛК;
			Лист1.Cells(НомерСтроки, 4).Value = Строка.РайонЛК;
			Лист1.Cells(НомерСтроки, 5).Value = Строка.СубъектРФНаименованиеЛК;
			НомерСтроки = НомерСтроки + 1;
		КонецЕсли;
	КонецЦикла;
	ЛогСтыковокПоНаименованию.Записать("G:\МКСКОМ\Зубков\логи интеграции октмо\Лог стыковок по наименованию.txt");
	
	Лист2.Cells(1, 1).Value = "Код ОКТМО";
	Лист2.Cells(1, 2).Value = "Наименование населенного пункта";
	Лист2.Cells(1, 3).Value = "Наименование сельского поселения";
	Лист2.Cells(1, 4).Value = "Наименование муниципального района/округа";
	Лист2.Cells(1, 5).Value = "Наименование субъекта РФ";
	Лист2.Cells(1, 6).Value = "Код КРСТ";
	НомерСтроки = 2;
	Для каждого Строка Из ТЗНестыковкиКРСТ Цикл
		Лист2.Cells(НомерСтроки, 1).Value = Строка.КодОКТМО;
		Лист2.Cells(НомерСтроки, 2).Value = Строка.Наименование;
		Лист2.Cells(НомерСтроки, 3).Value = Строка.СельскоеПоселение;
		Лист2.Cells(НомерСтроки, 4).Value = Строка.Район;
		Лист2.Cells(НомерСтроки, 5).Value = Строка.СубъектРФНаименование;
		Лист2.Cells(НомерСтроки, 6).Value = Строка.КодКРСТ;
		НомерСтроки = НомерСтроки + 1;
	КонецЦикла; 
	
	Книга.SaveAs("G:\МКСКОМ\Зубков\логи интеграции октмо\Лог нестыковок.xlsx");
	Excel.Quit();
